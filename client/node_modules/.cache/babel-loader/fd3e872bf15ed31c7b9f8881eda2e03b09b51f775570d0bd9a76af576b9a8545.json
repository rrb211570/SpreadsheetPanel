{"ast":null,"code":"import _slicedToArray from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import{store}from'../../../../../store/store.js';import{setSelection}from'../../../../../store/reducers/selectionSlice.js';function applySelectionHandler(entryCell){var selectionLayer=entryCell.querySelector('.coverDiv');var input=entryCell.querySelector('input');selectionLayer.addEventListener('mousedown',selectionLayerClickHandler);input.addEventListener('blur',inputBlurHandler);selectionLayer.addEventListener('dblclick',selectionLayerDoubleClickHandler);}function selectionLayerClickHandler(e){var _iterator=_createForOfIteratorHelper(store.getState().selection.entries.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var cell=_step.value;var _cell$split=cell.split(','),_cell$split2=_slicedToArray(_cell$split,2),_rowNum=_cell$split2[0],_colNum=_cell$split2[1];document.querySelector(\".row\".concat(_rowNum,\".col\").concat(_colNum,\">.coverDiv\")).style.boxShadow='none';}}catch(err){_iterator.e(err);}finally{_iterator.f();}e.target.focus();e.target.style.boxShadow='inset 0 0 0 2px blue';e.target.style.outline='none';var rowNum=parseInt(_toConsumableArray(e.target.parentElement.classList).filter(function(name){return /^row\\d+$/.test(name);})[0].match(/(\\d+)/)[0],10);var colNum=parseInt(_toConsumableArray(e.target.parentElement.classList).filter(function(name){return /^col\\d+$/.test(name);})[0].match(/(\\d+)/)[0],10);var cellValueDiv=e.target.parentElement.querySelector('.cellValueDiv');var cellValue=e.target.parentElement.querySelector('.cellValue');var categories={fontFamily:cellValue.style.fontFamily,fontSize:cellValue.style.fontSize==''?'12px':cellValue.style.fontSize,fontWeight:cellValue.style.fontWeight==''?'400':cellValue.style.fontWeight,fontStyle:cellValue.style.fontStyle==''?'normal':cellValue.style.fontStyle,textDecoration:cellValue.style.textDecoration==''?'none':cellValue.style.textDecoration,fontColor:cellValue.style.color==''?'black':cellValue.style.color,cellColor:cellValueDiv.style.backgroundColor==''?'white':cellValueDiv.style.backgroundColor,borders:cellValueDiv.style.boxShadow==''?[]:parseBoxShadow(cellValueDiv.style.boxShadow),horizontalAlignment:cellValue.style.textAlign==''?'center':cellValue.style.textAlign,verticalAlignment:cellValueDiv.style.justifyContent==''?'center':parseVerticalAlignment(cellValueDiv.style.justifyContent)};updateFormatPanelHighlights(categories);store.dispatch(setSelection({newEntries:[\"\".concat(rowNum,\",\").concat(colNum)],categories:categories}));updateCellViewPanel([\"\".concat(rowNum,\",\").concat(colNum)]);// css effect (cut/copy/paste)\n}function updateFormatPanelHighlights(categories){if(categories.fontWeight=='400')document.querySelector('.bold__btn').style.backgroundColor='white';else document.querySelector('.bold__btn').style.backgroundColor='rgb(204, 255, 162)';if(categories.fontStyle=='normal')document.querySelector('.italic__btn').style.backgroundColor='white';else document.querySelector('.italic__btn').style.backgroundColor='rgb(204, 255, 162)';if(categories.textDecoration=='none')document.querySelector('.strikethrough__btn').style.backgroundColor='white';else document.querySelector('.strikethrough__btn').style.backgroundColor='rgb(204, 255, 162)';}function updateCellViewPanel(selectedEntries){var cell=selectedEntries.values().next().value;var _cell$split3=cell.split(','),_cell$split4=_slicedToArray(_cell$split3,2),rowNum=_cell$split4[0],colNum=_cell$split4[1];var cellValue=document.querySelector(\".row\".concat(rowNum,\".col\").concat(colNum,\">.cellValueDiv>.cellValue\"));if(cellValue==null)return'';document.querySelector('#cellViewPanel__cellTextValue').innerText=cellValue.innerText;}function parseBoxShadow(term){var boxShadowLabels=[];if(term.includes('black 0px 3px 0px -1px inset'))boxShadowLabels.push('top');if(term.includes('black -3px 0px 0px -1px inset'))boxShadowLabels.push('right');if(term.includes('black 0px -3px 0px -1px inset'))boxShadowLabels.push('bottom');if(term.includes('black 3px 0px 0px -1px inset'))boxShadowLabels.push('left');return boxShadowLabels;}function parseVerticalAlignment(term){switch(term){case'flex-start':return'top';case'center':return'center';case'flex-end':return'bottom';default:break;}}function inputBlurHandler(e){e.target.parentElement.querySelector('.coverDiv').style.zIndex=2;e.target.style.opacity=0;e.target.parentElement.querySelector('.cellValue').style.opacity=1;}function selectionLayerDoubleClickHandler(e){e.target.style.zIndex=-1;e.target.parentElement.querySelector('.cellValue').style.opacity=0;e.target.parentElement.querySelector('input').style.opacity=1;e.target.parentElement.querySelector('input').focus();}export{applySelectionHandler,parseBoxShadow};","map":{"version":3,"names":["store","setSelection","applySelectionHandler","entryCell","selectionLayer","querySelector","input","addEventListener","selectionLayerClickHandler","inputBlurHandler","selectionLayerDoubleClickHandler","e","getState","selection","entries","values","cell","split","rowNum","colNum","document","style","boxShadow","target","focus","outline","parseInt","parentElement","classList","filter","name","test","match","cellValueDiv","cellValue","categories","fontFamily","fontSize","fontWeight","fontStyle","textDecoration","fontColor","color","cellColor","backgroundColor","borders","parseBoxShadow","horizontalAlignment","textAlign","verticalAlignment","justifyContent","parseVerticalAlignment","updateFormatPanelHighlights","dispatch","newEntries","updateCellViewPanel","selectedEntries","next","value","innerText","term","boxShadowLabels","includes","push","zIndex","opacity"],"sources":["C:/Users/rband/Desktop/SpreadsheetPanel/client/src/components/TablePanel/handlers/cellHandler/selectionHandler/selectionHandler.js"],"sourcesContent":["import { store } from '../../../../../store/store.js'\r\nimport { setSelection } from '../../../../../store/reducers/selectionSlice.js'\r\n\r\nfunction applySelectionHandler(entryCell) {\r\n    const selectionLayer = entryCell.querySelector('.coverDiv');\r\n    const input = entryCell.querySelector('input');\r\n\r\n    selectionLayer.addEventListener('mousedown', selectionLayerClickHandler);\r\n    input.addEventListener('blur', inputBlurHandler);\r\n    selectionLayer.addEventListener('dblclick', selectionLayerDoubleClickHandler);\r\n}\r\n\r\nfunction selectionLayerClickHandler(e) {\r\n    for (const cell of store.getState().selection.entries.values()) {\r\n        let [rowNum, colNum] = cell.split(',');\r\n        document.querySelector(`.row${rowNum}.col${colNum}>.coverDiv`).style.boxShadow = 'none';\r\n    }\r\n\r\n    e.target.focus();\r\n    e.target.style.boxShadow = 'inset 0 0 0 2px blue';\r\n    e.target.style.outline = 'none';\r\n\r\n    const rowNum = parseInt([...e.target.parentElement.classList].filter(name => /^row\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\r\n    const colNum = parseInt([...e.target.parentElement.classList].filter(name => /^col\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\r\n    let cellValueDiv = e.target.parentElement.querySelector('.cellValueDiv');\r\n    let cellValue = e.target.parentElement.querySelector('.cellValue');\r\n    let categories = {\r\n        fontFamily: cellValue.style.fontFamily,\r\n        fontSize: cellValue.style.fontSize == '' ? '12px' : cellValue.style.fontSize,\r\n        fontWeight: cellValue.style.fontWeight == '' ? '400' : cellValue.style.fontWeight,\r\n        fontStyle: cellValue.style.fontStyle == '' ? 'normal' : cellValue.style.fontStyle,\r\n        textDecoration: cellValue.style.textDecoration == '' ? 'none' : cellValue.style.textDecoration,\r\n        fontColor: cellValue.style.color == '' ? 'black' : cellValue.style.color,\r\n        cellColor: cellValueDiv.style.backgroundColor == '' ? 'white' : cellValueDiv.style.backgroundColor,\r\n        borders: cellValueDiv.style.boxShadow == '' ? [] : parseBoxShadow(cellValueDiv.style.boxShadow),\r\n        horizontalAlignment: cellValue.style.textAlign == '' ? 'center' : cellValue.style.textAlign,\r\n        verticalAlignment: cellValueDiv.style.justifyContent == '' ? 'center' : parseVerticalAlignment(cellValueDiv.style.justifyContent),\r\n    }\r\n    updateFormatPanelHighlights(categories);\r\n    store.dispatch(setSelection({ newEntries: [`${rowNum},${colNum}`], categories: categories }));\r\n    updateCellViewPanel([`${rowNum},${colNum}`]);\r\n    // css effect (cut/copy/paste)\r\n}\r\n\r\nfunction updateFormatPanelHighlights(categories) {\r\n    if (categories.fontWeight == '400') document.querySelector('.bold__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.bold__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n    if (categories.fontStyle == 'normal') document.querySelector('.italic__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.italic__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n    if (categories.textDecoration == 'none') document.querySelector('.strikethrough__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.strikethrough__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n}\r\n\r\nfunction updateCellViewPanel(selectedEntries) {\r\n    let cell = selectedEntries.values().next().value;\r\n    let [rowNum, colNum] = cell.split(',');\r\n    let cellValue = document.querySelector(`.row${rowNum}.col${colNum}>.cellValueDiv>.cellValue`);\r\n    if (cellValue == null) return '';\r\n    document.querySelector('#cellViewPanel__cellTextValue').innerText = cellValue.innerText;\r\n}\r\n\r\nfunction parseBoxShadow(term) {\r\n    let boxShadowLabels = [];\r\n    if (term.includes('black 0px 3px 0px -1px inset')) boxShadowLabels.push('top');\r\n    if (term.includes('black -3px 0px 0px -1px inset')) boxShadowLabels.push('right');\r\n    if (term.includes('black 0px -3px 0px -1px inset')) boxShadowLabels.push('bottom');\r\n    if (term.includes('black 3px 0px 0px -1px inset')) boxShadowLabels.push('left');\r\n    return boxShadowLabels;\r\n}\r\n\r\nfunction parseVerticalAlignment(term) {\r\n    switch (term) {\r\n        case 'flex-start': return 'top';\r\n        case 'center': return 'center';\r\n        case 'flex-end': return 'bottom';\r\n        default: break;\r\n    }\r\n}\r\n\r\nfunction inputBlurHandler(e) {\r\n    e.target.parentElement.querySelector('.coverDiv').style.zIndex = 2;\r\n    e.target.style.opacity = 0;\r\n    e.target.parentElement.querySelector('.cellValue').style.opacity = 1;\r\n}\r\n\r\nfunction selectionLayerDoubleClickHandler(e) {\r\n    e.target.style.zIndex = -1;\r\n    e.target.parentElement.querySelector('.cellValue').style.opacity = 0;\r\n    e.target.parentElement.querySelector('input').style.opacity = 1;\r\n    e.target.parentElement.querySelector('input').focus();\r\n}\r\n\r\nexport { applySelectionHandler, parseBoxShadow };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}