{"ast":null,"code":"import { store } from '../../../../../store/store.js';\nimport { setSelection } from '../../../../../store/reducers/selectionSlice.js';\nfunction applySelectionHandler(entryCell) {\n  const selectionLayer = entryCell.querySelector('.coverDiv');\n  const input = entryCell.querySelector('input');\n  selectionLayer.addEventListener('mousedown', selectionLayerClickHandler);\n  input.addEventListener('blur', inputBlurHandler);\n  selectionLayer.addEventListener('dblclick', selectionLayerDoubleClickHandler);\n}\nfunction selectionLayerClickHandler(e) {\n  for (const cell of store.getState().selection.entries.values()) {\n    let [rowNum, colNum] = cell.split(',');\n    document.querySelector(`.row${rowNum}.col${colNum}>.coverDiv`).style.boxShadow = 'none';\n  }\n  e.target.focus();\n  e.target.style.boxShadow = 'inset 0 0 0 2px blue';\n  e.target.style.outline = 'none';\n  const rowNum = parseInt([...e.target.parentElement.classList].filter(name => /^row\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\n  const colNum = parseInt([...e.target.parentElement.classList].filter(name => /^col\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\n  let cellValueDiv = e.target.parentElement.querySelector('.cellValueDiv');\n  let cellValue = e.target.parentElement.querySelector('.cellValue');\n  let categories = {\n    fontFamily: cellValue.style.fontFamily,\n    fontSize: cellValue.style.fontSize == '' ? '12px' : cellValue.style.fontSize,\n    fontWeight: cellValue.style.fontWeight == '' ? '400' : cellValue.style.fontWeight,\n    fontStyle: cellValue.style.fontStyle == '' ? 'normal' : cellValue.style.fontStyle,\n    textDecoration: cellValue.style.textDecoration == '' ? 'none' : cellValue.style.textDecoration,\n    fontColor: cellValue.style.color == '' ? 'black' : cellValue.style.color,\n    cellColor: cellValueDiv.style.backgroundColor == '' ? 'white' : cellValueDiv.style.backgroundColor,\n    borders: cellValueDiv.style.boxShadow == '' ? [] : parseBoxShadow(cellValueDiv.style.boxShadow),\n    horizontalAlignment: cellValue.style.textAlign == '' ? 'center' : cellValue.style.textAlign,\n    verticalAlignment: cellValueDiv.style.justifyContent == '' ? 'center' : parseVerticalAlignment(cellValueDiv.style.justifyContent)\n  };\n  updateFormatPanelHighlights(categories);\n  store.dispatch(setSelection({\n    newEntries: [`${rowNum},${colNum}`],\n    categories: categories\n  }));\n  updateCellViewPanel([`${rowNum},${colNum}`]);\n  // css effect (cut/copy/paste)\n}\n\nfunction updateFormatPanelHighlights(categories) {\n  if (categories.fontWeight == '400') document.querySelector('.bold__btn').style.backgroundColor = 'white';else document.querySelector('.bold__btn').style.backgroundColor = 'rgb(204, 255, 162)';\n  if (categories.fontStyle == 'normal') document.querySelector('.italic__btn').style.backgroundColor = 'white';else document.querySelector('.italic__btn').style.backgroundColor = 'rgb(204, 255, 162)';\n  if (categories.textDecoration == 'none') document.querySelector('.strikethrough__btn').style.backgroundColor = 'white';else document.querySelector('.strikethrough__btn').style.backgroundColor = 'rgb(204, 255, 162)';\n}\nfunction updateCellViewPanel(selectedEntries) {\n  let cell = selectedEntries.values().next().value;\n  let [rowNum, colNum] = cell.split(',');\n  let cellValue = document.querySelector(`.row${rowNum}.col${colNum}>.cellValueDiv>.cellValue`);\n  if (cellValue == null) return '';\n  document.querySelector('#cellViewPanel__cellTextValue').innerText = cellValue.innerText;\n}\nfunction parseBoxShadow(term) {\n  let boxShadowLabels = [];\n  if (term.includes('black 0px 3px 0px -1px inset')) boxShadowLabels.push('top');\n  if (term.includes('black -3px 0px 0px -1px inset')) boxShadowLabels.push('right');\n  if (term.includes('black 0px -3px 0px -1px inset')) boxShadowLabels.push('bottom');\n  if (term.includes('black 3px 0px 0px -1px inset')) boxShadowLabels.push('left');\n  return boxShadowLabels;\n}\nfunction parseVerticalAlignment(term) {\n  switch (term) {\n    case 'flex-start':\n      return 'top';\n    case 'center':\n      return 'center';\n    case 'flex-end':\n      return 'bottom';\n    default:\n      break;\n  }\n}\nfunction inputBlurHandler(e) {\n  e.target.parentElement.querySelector('.coverDiv').style.zIndex = 2;\n  e.target.style.opacity = 0;\n  e.target.parentElement.querySelector('.cellValue').style.opacity = 1;\n}\nfunction selectionLayerDoubleClickHandler(e) {\n  e.target.style.zIndex = -1;\n  e.target.parentElement.querySelector('.cellValue').style.opacity = 0;\n  e.target.parentElement.querySelector('input').style.opacity = 1;\n  e.target.parentElement.querySelector('input').focus();\n}\nexport { applySelectionHandler, parseBoxShadow };","map":{"version":3,"names":["store","setSelection","applySelectionHandler","entryCell","selectionLayer","querySelector","input","addEventListener","selectionLayerClickHandler","inputBlurHandler","selectionLayerDoubleClickHandler","e","cell","getState","selection","entries","values","rowNum","colNum","split","document","style","boxShadow","target","focus","outline","parseInt","parentElement","classList","filter","name","test","match","cellValueDiv","cellValue","categories","fontFamily","fontSize","fontWeight","fontStyle","textDecoration","fontColor","color","cellColor","backgroundColor","borders","parseBoxShadow","horizontalAlignment","textAlign","verticalAlignment","justifyContent","parseVerticalAlignment","updateFormatPanelHighlights","dispatch","newEntries","updateCellViewPanel","selectedEntries","next","value","innerText","term","boxShadowLabels","includes","push","zIndex","opacity"],"sources":["C:/Users/rband/Desktop/SpreadsheetPanel/client/src/components/TablePanel/handlers/cellHandler/selectionHandler/selectionHandler.js"],"sourcesContent":["import { store } from '../../../../../store/store.js'\r\nimport { setSelection } from '../../../../../store/reducers/selectionSlice.js'\r\n\r\nfunction applySelectionHandler(entryCell) {\r\n    const selectionLayer = entryCell.querySelector('.coverDiv');\r\n    const input = entryCell.querySelector('input');\r\n\r\n    selectionLayer.addEventListener('mousedown', selectionLayerClickHandler);\r\n    input.addEventListener('blur', inputBlurHandler);\r\n    selectionLayer.addEventListener('dblclick', selectionLayerDoubleClickHandler);\r\n}\r\n\r\nfunction selectionLayerClickHandler(e) {\r\n    for (const cell of store.getState().selection.entries.values()) {\r\n        let [rowNum, colNum] = cell.split(',');\r\n        document.querySelector(`.row${rowNum}.col${colNum}>.coverDiv`).style.boxShadow = 'none';\r\n    }\r\n\r\n    e.target.focus();\r\n    e.target.style.boxShadow = 'inset 0 0 0 2px blue';\r\n    e.target.style.outline = 'none';\r\n\r\n    const rowNum = parseInt([...e.target.parentElement.classList].filter(name => /^row\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\r\n    const colNum = parseInt([...e.target.parentElement.classList].filter(name => /^col\\d+$/.test(name))[0].match(/(\\d+)/)[0], 10);\r\n    let cellValueDiv = e.target.parentElement.querySelector('.cellValueDiv');\r\n    let cellValue = e.target.parentElement.querySelector('.cellValue');\r\n    let categories = {\r\n        fontFamily: cellValue.style.fontFamily,\r\n        fontSize: cellValue.style.fontSize == '' ? '12px' : cellValue.style.fontSize,\r\n        fontWeight: cellValue.style.fontWeight == '' ? '400' : cellValue.style.fontWeight,\r\n        fontStyle: cellValue.style.fontStyle == '' ? 'normal' : cellValue.style.fontStyle,\r\n        textDecoration: cellValue.style.textDecoration == '' ? 'none' : cellValue.style.textDecoration,\r\n        fontColor: cellValue.style.color == '' ? 'black' : cellValue.style.color,\r\n        cellColor: cellValueDiv.style.backgroundColor == '' ? 'white' : cellValueDiv.style.backgroundColor,\r\n        borders: cellValueDiv.style.boxShadow == '' ? [] : parseBoxShadow(cellValueDiv.style.boxShadow),\r\n        horizontalAlignment: cellValue.style.textAlign == '' ? 'center' : cellValue.style.textAlign,\r\n        verticalAlignment: cellValueDiv.style.justifyContent == '' ? 'center' : parseVerticalAlignment(cellValueDiv.style.justifyContent),\r\n    }\r\n    updateFormatPanelHighlights(categories);\r\n    store.dispatch(setSelection({ newEntries: [`${rowNum},${colNum}`], categories: categories }));\r\n    updateCellViewPanel([`${rowNum},${colNum}`]);\r\n    // css effect (cut/copy/paste)\r\n}\r\n\r\nfunction updateFormatPanelHighlights(categories) {\r\n    if (categories.fontWeight == '400') document.querySelector('.bold__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.bold__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n    if (categories.fontStyle == 'normal') document.querySelector('.italic__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.italic__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n    if (categories.textDecoration == 'none') document.querySelector('.strikethrough__btn').style.backgroundColor = 'white';\r\n    else document.querySelector('.strikethrough__btn').style.backgroundColor = 'rgb(204, 255, 162)';\r\n}\r\n\r\nfunction updateCellViewPanel(selectedEntries) {\r\n    let cell = selectedEntries.values().next().value;\r\n    let [rowNum, colNum] = cell.split(',');\r\n    let cellValue = document.querySelector(`.row${rowNum}.col${colNum}>.cellValueDiv>.cellValue`);\r\n    if (cellValue == null) return '';\r\n    document.querySelector('#cellViewPanel__cellTextValue').innerText = cellValue.innerText;\r\n}\r\n\r\nfunction parseBoxShadow(term) {\r\n    let boxShadowLabels = [];\r\n    if (term.includes('black 0px 3px 0px -1px inset')) boxShadowLabels.push('top');\r\n    if (term.includes('black -3px 0px 0px -1px inset')) boxShadowLabels.push('right');\r\n    if (term.includes('black 0px -3px 0px -1px inset')) boxShadowLabels.push('bottom');\r\n    if (term.includes('black 3px 0px 0px -1px inset')) boxShadowLabels.push('left');\r\n    return boxShadowLabels;\r\n}\r\n\r\nfunction parseVerticalAlignment(term) {\r\n    switch (term) {\r\n        case 'flex-start': return 'top';\r\n        case 'center': return 'center';\r\n        case 'flex-end': return 'bottom';\r\n        default: break;\r\n    }\r\n}\r\n\r\nfunction inputBlurHandler(e) {\r\n    e.target.parentElement.querySelector('.coverDiv').style.zIndex = 2;\r\n    e.target.style.opacity = 0;\r\n    e.target.parentElement.querySelector('.cellValue').style.opacity = 1;\r\n}\r\n\r\nfunction selectionLayerDoubleClickHandler(e) {\r\n    e.target.style.zIndex = -1;\r\n    e.target.parentElement.querySelector('.cellValue').style.opacity = 0;\r\n    e.target.parentElement.querySelector('input').style.opacity = 1;\r\n    e.target.parentElement.querySelector('input').focus();\r\n}\r\n\r\nexport { applySelectionHandler, parseBoxShadow };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}