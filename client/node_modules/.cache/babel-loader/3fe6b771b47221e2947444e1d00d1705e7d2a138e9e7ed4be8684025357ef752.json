{"ast":null,"code":"import _toConsumableArray from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import{store}from'../../../../store/store.js';import{logError,logSuccess}from'../../../../tests/helper.js';import{getInLine,nextTurn}from'../../../../tests/sequenceHelpers.js';import{DOWN,CONTROL,META,SHIFT,Z,Y,UNDO_DISPATCH,UNDO_FINISH,REDO_DISPATCH,REDO_FINISH,FLUFF_FULL}from'./keyMacros.js';var UNDO='Undo';var REDO='Redo';var NO_CHANGE='No Change';var WAIT_IN_QUEUE=-1;var ARRANGE_AND_ACTION=0;var ASSERT=1;function keyInputTest(atomicTurn){var events=[UNDO_DISPATCH,UNDO_FINISH,UNDO_DISPATCH,UNDO_FINISH,REDO_DISPATCH,REDO_FINISH,REDO_DISPATCH,REDO_FINISH,REDO_DISPATCH,REDO_FINISH,FLUFF_FULL];var totalTestCases=validateSequence(events);if(totalTestCases==-1)return;var testCaseIndex=1;try{var keyState=new Set();for(var i=0;i<events.length;++i){for(var j=0;j<events[i].length;++j){if(i==0&&j==0)checkReactionOfKeyInput(testCaseIndex,events[i][j],keyState,atomicTurn,true,totalTestCases);else checkReactionOfKeyInput(++testCaseIndex,events[i][j],keyState,atomicTurn,false,totalTestCases);}}}catch(e){console.log('Error: checkReactionOfKeyInput param error: '+e);logError(null,e);}}function checkReactionOfKeyInput(testCaseIndex,keyEvent,keyState,atomicTurn,isFirstCall,totalTestCases){var sheet=document.querySelector('#spreadsheet');var predictedKeyOutcome=null;var predictedChange=null;var recordedTimeTravelCounter;var myTurnNumber=getInLine(atomicTurn);var stage=WAIT_IN_QUEUE;var timer=setInterval(function(){try{var storeState=store.getState();var currentTimeTravelCounter=storeState.keyboardEvents.timeTravelCounter;var outcome=storeState.keyboardEvents.outcome;switch(stage){case WAIT_IN_QUEUE:if(atomicTurn.current==myTurnNumber){if(isFirstCall)console.log('\\n--------KEY INPUT TEST--------------------');stage=ARRANGE_AND_ACTION;}break;case ARRANGE_AND_ACTION:recordedTimeTravelCounter=currentTimeTravelCounter;predictedKeyOutcome=updateKeyState(keyState,keyEvent);if(predictedKeyOutcome!=NO_CHANGE){predictedChange=capturePredictedChange(predictedKeyOutcome,timer);}else predictedChange=NO_CHANGE;sheet.dispatchEvent(new KeyboardEvent(keyEvent.status==DOWN?'keydown':'keyup',{key:keyEvent.id,bubbles:true}));stage=ASSERT;break;case ASSERT:if(predictionMatchesActualEvent(predictedKeyOutcome,outcome,recordedTimeTravelCounter,currentTimeTravelCounter,keyEvent)){console.log('-------------- Event: '+predictedKeyOutcome);compareStoreAndDOM(predictedKeyOutcome,predictedChange);}if(testCaseIndex==totalTestCases)logSuccess('keyInputTest()',totalTestCases);nextTurn(atomicTurn);clearInterval(timer);break;default:break;}}catch(e){var errMsg='Err: checkReactionOfKeyInput(): { testCaseIndex: '+testCaseIndex+' } : '+e;console.log(errMsg);logError(errMsg);nextTurn(atomicTurn);clearInterval(timer);}},100);}// Check that no impossible events happen, like CTRL_UP w/o a corresponding prior CTRL_DOWN\n// Also ensure the sequence is finished, that all 'DOWN' events are followed by corresponding 'UP' events\nfunction validateSequence(events){try{var seen=new Set();var totalEvents=0;for(var i=0;i<events.length;++i){for(var j=0;j<events[i].length;++j){var key=events[i][j];if(key.status==DOWN){if(seen.has(key.id)){throw'keyInputTest(): encountered duplicate DOWN event w/o necessary UP event in-between\\nkey: '+key.id+' '+key.status+' i: '+i+' j: '+j;}else seen.add(key.id);}else if(seen.has(key.id)){seen.delete(key.id);}else throw'keyInputTest(): UP event encountered without prior corresponding DOWN event\\nkey: '+key.id+' '+key.status+' i: '+i+' j: '+j;totalEvents++;}}if(seen.size>0)throw'keyInputTest(): unfinished sequence (one or more DOWN events are missing concluding UP event)';return totalEvents;}catch(e){console.log('Error: '+e);return-1;}}function updateKeyState(keyState,key){if(key.status==DOWN){keyState.add(key.id);if(key.id==Z&&(keyState.has(CONTROL)||keyState.has(META))&&!keyState.has(SHIFT))return UNDO;else if(key.id==Y&&(keyState.has(CONTROL)||keyState.has(META))&&!keyState.has(SHIFT))return REDO;}else keyState.delete(key.id);return NO_CHANGE;}function capturePredictedChange(predictedKeyOutcome){var storeState=store.getState();var changeHistoryIndex=storeState.history.changeHistoryIndex;var changeHistory=storeState.history.changeHistory;var delta;if(predictedKeyOutcome==UNDO){delta=-1;}else if(predictedKeyOutcome==REDO){delta=1;}else throw'capturePredictedChange(): currently unsupported outcome: '+predictedKeyOutcome;var newIndex=changeHistoryIndex+delta;if(newIndex<0||newIndex>=changeHistory.length)return NO_CHANGE;else return{predictedIndex:changeHistoryIndex+delta,predictedHistoryState:changeHistory[changeHistoryIndex+delta]};}function predictionMatchesActualEvent(predictedKeyOutcome,currentKeyOutcome,previousTimeTravelCounter,currentTimeTravelCounter,key){if(currentKeyOutcome!=predictedKeyOutcome)throw'Error: keyInputTest(): key event outcome does not match prediction:\\nkey: '+key.id+' '+key.status+'\\nPredicted: '+predictedKeyOutcome+'\\nActual: '+currentKeyOutcome;if(predictedKeyOutcome!=null&&previousTimeTravelCounter+1==currentTimeTravelCounter)return true;else return false;}function compareStoreAndDOM(predictedKeyOutcome,predictedChange){if(predictedChange==NO_CHANGE){console.log('NO CHANGE');return;}var changeHistoryIndex=store.getState().history.changeHistoryIndex;if(changeHistoryIndex!=predictedChange.predictedIndex)throw'changeHistoryIndex not updated correctly';if(predictedKeyOutcome==UNDO){compareWithDOM(predictedChange.predictedHistoryState);}else if(predictedKeyOutcome==REDO){compareWithDOM(predictedChange.predictedHistoryState);}else console.log('compareStoreAndDOM(): unrecognized predictedKeyOutcome: '+predictedKeyOutcome);}function compareWithDOM(predictedHistoryState){var _iterator=_createForOfIteratorHelper(predictedHistoryState.getIndividualEntries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),entryKey=_step$value[0],data=_step$value[1];if(entryKey=='spreadsheet')compareSheet(data.getStyleMap());else if(!/\\.col\\d+/.test(entryKey)){var entry=document.getElementById(entryKey.match(/\\.row\\d+/));compareEntry(entry,data.getStyleMap());}else{var _entry=document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));compareEntry(_entry,data.getStyleMap(),data.getVal());}}}catch(err){_iterator.e(err);}finally{_iterator.f();}var _iterator2=_createForOfIteratorHelper(predictedHistoryState.getGroupEntries()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),group=_step2$value[0],styleMap=_step2$value[1];compareGroup(group,styleMap);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}function compareSheet(styleMap){var h=null;var w=null;var _iterator3=_createForOfIteratorHelper(styleMap.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),property=_step3$value[0],value=_step3$value[1];if(property=='height')h=value;else if(property=='width')w=value;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}document.getElementById('spreadsheet').querySelectorAll('.resizer-horizontal').forEach(function(resizer){if(h!=null&&resizer.style.height!=h+'px')throw'compareSheet() failed on resizer height';});document.getElementById('spreadsheet').querySelectorAll('.resizer-vertical').forEach(function(resizer){if(w!=null&&resizer.style.width!=w+'px')throw'compareSheet() failed on resizer width';});var dimensions=store.getState().sheetDimensions;if(h!=null&&dimensions.tableHeight!=h||w!=null&&dimensions.tableWidth!=w)throw'compareSheet() failed on sheet dimensions';}function compareEntry(entry,styleMap,val){if(val!=null&&entry.querySelector('input').value!=val)throw'compareEntry() failed on value';var _iterator4=_createForOfIteratorHelper(styleMap.entries()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),property=_step4$value[0],value=_step4$value[1];switch(property){case'height':if(entry.style.height=!value+'px')throw'compareEntry() failed on height';if(_toConsumableArray(entry.classList).filter(function(name){return /^col0$/.test(name);}).length!=0&&entry.style.lineHeight!=value+'px'){throw'compareEntry() failed on lineHeight of a specific Y axis cell';}if(_toConsumableArray(entry.classList).filter(function(name){return /^row0$/.test(name);}).length==0&&_toConsumableArray(entry.classList).filter(function(name){return /^col0$/.test(name);}).length==0&&_toConsumableArray(entry.classList).filter(function(name){return /^col\\d+$/.test(name);}).length!=0&&entry.querySelector('input').style.height!=value-4+'px'&&entry.querySelector('#cover').style.height!=value+'px'){throw'compareEntry() failed on input and cover heights';}break;case'width':entry.style.width=value+'px';if(_toConsumableArray(entry.classList).filter(function(name){return /^row0$/.test(name);}).length==0&&_toConsumableArray(entry.classList).filter(function(name){return /^col0$/.test(name);}).length==0&&_toConsumableArray(entry.classList).filter(function(name){return /^col\\d+$/.test(name);}).length!=0&&entry.querySelector('input').style.width!=value-4+'px'&&entry.querySelector('#cover').style.width!=value+'px'){throw'compareEntry() failed on input and cover widths';}break;case'marginLeft':if(entry.style.marginLeft!=value+'px')throw'compareEntry() failed on marginLeft';break;}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}function compareGroup(group,styleMap){if(/^\\.col\\d+$/.test(group)){var _iterator5=_createForOfIteratorHelper(styleMap),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),property=_step5$value[0],value=_step5$value[1];if(property=='width'){var entries=document.querySelectorAll(group);var dx=value-parseInt(entries[0].style.width,10);if(entries[0].style.width!=value+'px')throw'compareGroup() failed on width';for(var i=1;i<entries.length;++i){if(entries[i].style.width!=value+'px')throw'compareGroup() failed on width';if(entries[i].querySelector('input').style.width!=value-8+'px')throw'compareGroup() failed on inputWidth';if(entries[i].querySelector('.selectionLayer').style.width!=value+'px')throw'compareGroup() failed on selectionWidth';if(entries[i].querySelector('.highlightLayer').style.width!=value-4+'px')throw'compareGroup() failed on highlightWidth';}var colNum=parseInt(group.match(/(\\d+)/)[0],10);// check that cells do not overlap\nvar elem=null;var prevMarginLeft=document.querySelector(\".col\".concat(colNum)).style.marginLeft;var prevWidth=document.querySelector(\".col\".concat(colNum)).style.width;while((elem=document.querySelector(\".col\".concat(++colNum)))!=null){var expectedMarginLeft=parseInt(prevMarginLeft,10)+parseInt(prevWidth,10)+'px';var _entries=document.querySelectorAll(\".col\".concat(colNum));for(var _i=0;_i<_entries.length;++_i){if(_entries[_i].style.marginLeft!=expectedMarginLeft)throw'compareGroup() failed on marginLeft';}prevMarginLeft=_entries[0].style.marginLeft;prevWidth=_entries[0].style.width;}}}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}else if(/^\\.row\\d+$/.test(group)){var _iterator6=_createForOfIteratorHelper(styleMap),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _step6$value=_slicedToArray(_step6.value,2),_property=_step6$value[0],_value=_step6$value[1];if(_property=='height'){var _entries2=document.querySelectorAll(group);_entries2[0].style.height=_value+'px';_entries2[1].style.height=_value+'px';_entries2[1].style.lineHeight=_value+'px';for(var _i2=2;_i2<_entries2.length;++_i2){if(_entries2[_i2].style.height!=_value+'px')throw'compareGroup() failed on height';if(_entries2[_i2].querySelector('input').style.height!=_value-6+'px')throw'compareGroup() failed on inputHeight';if(_entries2[_i2].querySelector('.selectionLayer').style.height!=_value+'px')throw'compareGroup() failed on selectionHeight';if(_entries2[_i2].querySelector('.highlightLayer').style.height!=_value-4+'px')throw'compareGroup() failed on highlightHeight';}}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}}export{keyInputTest,checkReactionOfKeyInput,validateSequence};","map":{"version":3,"names":["store","logError","logSuccess","getInLine","nextTurn","DOWN","CONTROL","META","SHIFT","Z","Y","UNDO_DISPATCH","UNDO_FINISH","REDO_DISPATCH","REDO_FINISH","FLUFF_FULL","UNDO","REDO","NO_CHANGE","WAIT_IN_QUEUE","ARRANGE_AND_ACTION","ASSERT","keyInputTest","atomicTurn","events","totalTestCases","validateSequence","testCaseIndex","keyState","Set","i","length","j","checkReactionOfKeyInput","e","console","log","keyEvent","isFirstCall","sheet","document","querySelector","predictedKeyOutcome","predictedChange","recordedTimeTravelCounter","myTurnNumber","stage","timer","setInterval","storeState","getState","currentTimeTravelCounter","keyboardEvents","timeTravelCounter","outcome","current","updateKeyState","capturePredictedChange","dispatchEvent","KeyboardEvent","status","key","id","bubbles","predictionMatchesActualEvent","compareStoreAndDOM","clearInterval","errMsg","seen","totalEvents","has","add","delete","size","changeHistoryIndex","history","changeHistory","delta","newIndex","predictedIndex","predictedHistoryState","currentKeyOutcome","previousTimeTravelCounter","compareWithDOM","getIndividualEntries","entryKey","data","compareSheet","getStyleMap","test","entry","getElementById","match","compareEntry","getVal","getGroupEntries","group","styleMap","compareGroup","h","w","entries","property","value","querySelectorAll","forEach","resizer","style","height","width","dimensions","sheetDimensions","tableHeight","tableWidth","val","classList","filter","name","lineHeight","marginLeft","dx","parseInt","colNum","elem","prevMarginLeft","prevWidth","expectedMarginLeft"],"sources":["C:/Users/rband/Desktop/SpreadsheetPanel/client/src/components/SpreadSheetPanel/handlers/keyboardEvents/test.js"],"sourcesContent":["import { store } from '../../../../store/store.js'\r\nimport { logError, logSuccess } from '../../../../tests/helper.js';\r\nimport { getInLine, nextTurn } from '../../../../tests/sequenceHelpers.js'\r\nimport { DOWN, CONTROL, META, SHIFT, Z, Y, UNDO_DISPATCH, UNDO_FINISH, REDO_DISPATCH, REDO_FINISH, FLUFF_FULL } from './keyMacros.js'\r\nconst UNDO = 'Undo';\r\nconst REDO = 'Redo';\r\nconst NO_CHANGE = 'No Change'\r\n\r\nconst WAIT_IN_QUEUE = -1;\r\nconst ARRANGE_AND_ACTION = 0;\r\nconst ASSERT = 1;\r\n\r\nfunction keyInputTest(atomicTurn) {\r\n    let events = [UNDO_DISPATCH, UNDO_FINISH, UNDO_DISPATCH, UNDO_FINISH, REDO_DISPATCH, REDO_FINISH, REDO_DISPATCH, REDO_FINISH, REDO_DISPATCH, REDO_FINISH, FLUFF_FULL];\r\n    let totalTestCases = validateSequence(events);\r\n    if (totalTestCases == -1) return;\r\n    let testCaseIndex = 1;\r\n\r\n    try {\r\n        let keyState = new Set();\r\n        for (let i = 0; i < events.length; ++i) {\r\n            for (let j = 0; j < events[i].length; ++j) {\r\n                if (i == 0 && j == 0) checkReactionOfKeyInput(testCaseIndex, events[i][j], keyState, atomicTurn, true, totalTestCases);\r\n                else checkReactionOfKeyInput(++testCaseIndex, events[i][j], keyState, atomicTurn, false, totalTestCases);\r\n            }\r\n        }\r\n    } catch (e) {\r\n        console.log('Error: checkReactionOfKeyInput param error: ' + e);\r\n        logError(null, e);\r\n    }\r\n}\r\n\r\nfunction checkReactionOfKeyInput(testCaseIndex, keyEvent, keyState, atomicTurn, isFirstCall, totalTestCases) {\r\n    let sheet = document.querySelector('#spreadsheet');\r\n    let predictedKeyOutcome = null;\r\n    let predictedChange = null;\r\n    let recordedTimeTravelCounter;\r\n    let myTurnNumber = getInLine(atomicTurn);\r\n    let stage = WAIT_IN_QUEUE;\r\n\r\n    let timer = setInterval(() => {\r\n        try {\r\n            let storeState = store.getState();\r\n            let currentTimeTravelCounter = storeState.keyboardEvents.timeTravelCounter;\r\n            let outcome = storeState.keyboardEvents.outcome;\r\n            switch (stage) {\r\n                case WAIT_IN_QUEUE:\r\n                    if (atomicTurn.current == myTurnNumber) {\r\n                        if (isFirstCall) console.log('\\n--------KEY INPUT TEST--------------------');\r\n                        stage = ARRANGE_AND_ACTION;\r\n                    }\r\n                    break;\r\n                case ARRANGE_AND_ACTION:\r\n                    recordedTimeTravelCounter = currentTimeTravelCounter;\r\n                    predictedKeyOutcome = updateKeyState(keyState, keyEvent);\r\n                    if (predictedKeyOutcome != NO_CHANGE) {\r\n                        predictedChange = capturePredictedChange(predictedKeyOutcome, timer);\r\n                    } else predictedChange = NO_CHANGE;\r\n                    sheet.dispatchEvent(new KeyboardEvent(keyEvent.status == DOWN ? 'keydown' : 'keyup', { key: keyEvent.id, bubbles: true }));\r\n                    stage = ASSERT;\r\n                    break;\r\n                case ASSERT:\r\n                    if (predictionMatchesActualEvent(predictedKeyOutcome, outcome, recordedTimeTravelCounter, currentTimeTravelCounter, keyEvent)) {\r\n                        console.log('-------------- Event: ' + predictedKeyOutcome);\r\n                        compareStoreAndDOM(predictedKeyOutcome, predictedChange);\r\n                    }\r\n                    if (testCaseIndex == totalTestCases) logSuccess('keyInputTest()', totalTestCases);\r\n                    nextTurn(atomicTurn);\r\n                    clearInterval(timer);\r\n                    break;\r\n                default: break;\r\n            }\r\n        } catch (e) {\r\n            let errMsg = 'Err: checkReactionOfKeyInput(): { testCaseIndex: ' + testCaseIndex + ' } : ' + e;\r\n            console.log(errMsg);\r\n            logError(errMsg);\r\n            nextTurn(atomicTurn);\r\n            clearInterval(timer);\r\n        }\r\n    }, 100);\r\n}\r\n\r\n// Check that no impossible events happen, like CTRL_UP w/o a corresponding prior CTRL_DOWN\r\n// Also ensure the sequence is finished, that all 'DOWN' events are followed by corresponding 'UP' events\r\nfunction validateSequence(events) {\r\n    try {\r\n        let seen = new Set();\r\n        let totalEvents = 0;\r\n        for (let i = 0; i < events.length; ++i) {\r\n            for (let j = 0; j < events[i].length; ++j) {\r\n                let key = events[i][j];\r\n                if (key.status == DOWN) {\r\n                    if (seen.has(key.id)) {\r\n                        throw 'keyInputTest(): encountered duplicate DOWN event w/o necessary UP event in-between\\nkey: ' + key.id + ' ' + key.status + ' i: ' + i + ' j: ' + j;\r\n                    } else seen.add(key.id);\r\n                } else if (seen.has(key.id)) {\r\n                    seen.delete(key.id);\r\n                } else throw 'keyInputTest(): UP event encountered without prior corresponding DOWN event\\nkey: ' + key.id + ' ' + key.status + ' i: ' + i + ' j: ' + j;\r\n                totalEvents++;\r\n            }\r\n        }\r\n        if (seen.size > 0) throw 'keyInputTest(): unfinished sequence (one or more DOWN events are missing concluding UP event)'\r\n        return totalEvents;\r\n    } catch (e) {\r\n        console.log('Error: ' + e);\r\n        return -1;\r\n    }\r\n}\r\n\r\nfunction updateKeyState(keyState, key) {\r\n    if (key.status == DOWN) {\r\n        keyState.add(key.id);\r\n        if (key.id == Z && (keyState.has(CONTROL) || keyState.has(META)) && !keyState.has(SHIFT)) return UNDO;\r\n        else if (key.id == Y && (keyState.has(CONTROL) || keyState.has(META)) && !keyState.has(SHIFT)) return REDO;\r\n    } else keyState.delete(key.id);\r\n    return NO_CHANGE;\r\n}\r\n\r\nfunction capturePredictedChange(predictedKeyOutcome) {\r\n    let storeState = store.getState();\r\n    let changeHistoryIndex = storeState.history.changeHistoryIndex;\r\n    let changeHistory = storeState.history.changeHistory;\r\n    let delta;\r\n    if (predictedKeyOutcome == UNDO) {\r\n        delta = -1;\r\n    } else if (predictedKeyOutcome == REDO) {\r\n        delta = 1;\r\n    } else throw 'capturePredictedChange(): currently unsupported outcome: ' + predictedKeyOutcome;\r\n    let newIndex = changeHistoryIndex + delta;\r\n    if (newIndex < 0 || newIndex >= changeHistory.length) return NO_CHANGE;\r\n    else return { predictedIndex: changeHistoryIndex + delta, predictedHistoryState: changeHistory[changeHistoryIndex + delta] };\r\n}\r\n\r\nfunction predictionMatchesActualEvent(predictedKeyOutcome, currentKeyOutcome, previousTimeTravelCounter, currentTimeTravelCounter, key) {\r\n    if (currentKeyOutcome != predictedKeyOutcome) throw 'Error: keyInputTest(): key event outcome does not match prediction:\\nkey: ' + key.id + ' ' + key.status + '\\nPredicted: ' + predictedKeyOutcome + '\\nActual: ' + currentKeyOutcome;\r\n    if (predictedKeyOutcome != null && previousTimeTravelCounter + 1 == currentTimeTravelCounter) return true;\r\n    else return false;\r\n}\r\n\r\nfunction compareStoreAndDOM(predictedKeyOutcome, predictedChange) {\r\n    if (predictedChange == NO_CHANGE) {\r\n        console.log('NO CHANGE');\r\n        return;\r\n    }\r\n    let changeHistoryIndex = store.getState().history.changeHistoryIndex;\r\n    if (changeHistoryIndex != predictedChange.predictedIndex) throw ('changeHistoryIndex not updated correctly');\r\n\r\n    if (predictedKeyOutcome == UNDO) {\r\n        compareWithDOM(predictedChange.predictedHistoryState);\r\n    } else if (predictedKeyOutcome == REDO) {\r\n        compareWithDOM(predictedChange.predictedHistoryState);\r\n    } else console.log('compareStoreAndDOM(): unrecognized predictedKeyOutcome: ' + predictedKeyOutcome);\r\n}\r\n\r\nfunction compareWithDOM(predictedHistoryState) {\r\n    for (const [entryKey, data] of predictedHistoryState.getIndividualEntries()) {\r\n        if (entryKey == 'spreadsheet') compareSheet(data.getStyleMap());\r\n        else if (!/\\.col\\d+/.test(entryKey)) {\r\n            let entry = document.getElementById(entryKey.match(/\\.row\\d+/));\r\n            compareEntry(entry, data.getStyleMap());\r\n        } else {\r\n            let entry = document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));\r\n            compareEntry(entry, data.getStyleMap(), data.getVal());\r\n        }\r\n    }\r\n    for (const [group, styleMap] of predictedHistoryState.getGroupEntries()) {\r\n        compareGroup(group, styleMap);\r\n    }\r\n}\r\n\r\nfunction compareSheet(styleMap) {\r\n    let h = null;\r\n    let w = null;\r\n    for (const [property, value] of styleMap.entries()) {\r\n        if (property == 'height') h = value;\r\n        else if (property == 'width') w = value;\r\n    }\r\n    document.getElementById('spreadsheet').querySelectorAll('.resizer-horizontal').forEach(resizer => {\r\n        if (h != null && resizer.style.height != h + 'px') throw 'compareSheet() failed on resizer height';\r\n    });\r\n    document.getElementById('spreadsheet').querySelectorAll('.resizer-vertical').forEach(resizer => {\r\n        if (w != null && resizer.style.width != w + 'px') throw 'compareSheet() failed on resizer width';\r\n    });\r\n    let dimensions = store.getState().sheetDimensions;\r\n    if ((h != null && dimensions.tableHeight != h) || (w != null && dimensions.tableWidth != w)) throw 'compareSheet() failed on sheet dimensions';\r\n}\r\n\r\nfunction compareEntry(entry, styleMap, val) {\r\n    if (val != null && entry.querySelector('input').value != val) throw 'compareEntry() failed on value';\r\n    for (const [property, value] of styleMap.entries()) {\r\n        switch (property) {\r\n            case 'height':\r\n                if (entry.style.height = !value + 'px') throw 'compareEntry() failed on height';\r\n                if ([...entry.classList].filter(name => /^col0$/.test(name)).length != 0 && entry.style.lineHeight != value + 'px') {\r\n                    throw 'compareEntry() failed on lineHeight of a specific Y axis cell';\r\n                }\r\n                if ([...entry.classList].filter(name => /^row0$/.test(name)).length == 0 &&\r\n                    [...entry.classList].filter(name => /^col0$/.test(name)).length == 0 &&\r\n                    [...entry.classList].filter(name => /^col\\d+$/.test(name)).length != 0 &&\r\n                    entry.querySelector('input').style.height != value - 4 + 'px' &&\r\n                    entry.querySelector('#cover').style.height != value + 'px') {\r\n                    throw 'compareEntry() failed on input and cover heights';\r\n                }\r\n                break;\r\n            case 'width':\r\n                entry.style.width = value + 'px';\r\n                if ([...entry.classList].filter(name => /^row0$/.test(name)).length == 0 &&\r\n                    [...entry.classList].filter(name => /^col0$/.test(name)).length == 0 &&\r\n                    [...entry.classList].filter(name => /^col\\d+$/.test(name)).length != 0 &&\r\n                    entry.querySelector('input').style.width != value - 4 + 'px' &&\r\n                    entry.querySelector('#cover').style.width != value + 'px') {\r\n                    throw 'compareEntry() failed on input and cover widths';\r\n                }\r\n                break;\r\n            case 'marginLeft':\r\n                if (entry.style.marginLeft != value + 'px') throw 'compareEntry() failed on marginLeft';\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\nfunction compareGroup(group, styleMap) {\r\n    if (/^\\.col\\d+$/.test(group)) {\r\n        for (const [property, value] of styleMap) {\r\n            if (property == 'width') {\r\n                let entries = document.querySelectorAll(group);\r\n                let dx = value - parseInt(entries[0].style.width, 10);\r\n                if (entries[0].style.width != value + 'px') throw 'compareGroup() failed on width';\r\n                for (let i = 1; i < entries.length; ++i) {\r\n                    if (entries[i].style.width != value + 'px') throw 'compareGroup() failed on width';\r\n                    if (entries[i].querySelector('input').style.width != value - 8 + 'px') throw 'compareGroup() failed on inputWidth';\r\n                    if (entries[i].querySelector('.selectionLayer').style.width != value + 'px') throw 'compareGroup() failed on selectionWidth';\r\n                    if (entries[i].querySelector('.highlightLayer').style.width != value - 4 + 'px') throw 'compareGroup() failed on highlightWidth';\r\n                }\r\n                let colNum = parseInt(group.match(/(\\d+)/)[0], 10); // check that cells do not overlap\r\n                let elem = null;\r\n                let prevMarginLeft = document.querySelector(`.col${colNum}`).style.marginLeft;\r\n                let prevWidth = document.querySelector(`.col${colNum}`).style.width;\r\n                while ((elem = document.querySelector(`.col${++colNum}`)) != null) {\r\n                    let expectedMarginLeft = parseInt(prevMarginLeft, 10) + parseInt(prevWidth, 10) + 'px';\r\n                    let entries = document.querySelectorAll(`.col${colNum}`);\r\n                    for (let i = 0; i < entries.length; ++i) {\r\n                        if (entries[i].style.marginLeft != expectedMarginLeft) throw 'compareGroup() failed on marginLeft';\r\n                    }\r\n                    prevMarginLeft = entries[0].style.marginLeft;\r\n                    prevWidth = entries[0].style.width;\r\n                }\r\n            }\r\n        }\r\n    } else if (/^\\.row\\d+$/.test(group)) {\r\n        for (const [property, value] of styleMap) {\r\n            if (property == 'height') {\r\n                let entries = document.querySelectorAll(group);\r\n                entries[0].style.height = value + 'px';\r\n                entries[1].style.height = value + 'px';\r\n                entries[1].style.lineHeight = value + 'px';\r\n                for (let i = 2; i < entries.length; ++i) {\r\n                    if (entries[i].style.height != value + 'px') throw 'compareGroup() failed on height';\r\n                    if (entries[i].querySelector('input').style.height != value - 6 + 'px') throw 'compareGroup() failed on inputHeight';\r\n                    if (entries[i].querySelector('.selectionLayer').style.height != value + 'px') throw 'compareGroup() failed on selectionHeight';\r\n                    if (entries[i].querySelector('.highlightLayer').style.height != value - 4 + 'px') throw 'compareGroup() failed on highlightHeight';\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport { keyInputTest, checkReactionOfKeyInput, validateSequence };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}