{"ast":null,"code":"import _slicedToArray from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"C:/Users/rband/Desktop/SpreadsheetPanel/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import{updateTableDimensions,applyChange,applyGroupChange}from'./applyChange.js';import updateCollectedData from'./updateCollectedData.js';import{store}from'./../../store/store.js';import{trackEvent}from\"./../../store/reducers/keyboardEventsSlice.js\";import{undo as undoAction,redo as redoAction}from'./../../store/reducers/historySlice.js';var UNDO='Undo';var REDO='Redo';function undo(){var storeState=store.getState();var changeHistoryIndex=storeState.history.changeHistoryIndex;var changeHistory=storeState.history.changeHistory;var collectedData=storeState.history.collectedData;var enableTest=storeState.keyboardEvents.enableTest;var timeTravelCounter=storeState.keyboardEvents.timeTravelCounter;if(changeHistoryIndex>0){if(enableTest)store.dispatch(trackEvent({outcome:UNDO,timeTravelCounter:timeTravelCounter+1}));var _iterator=_createForOfIteratorHelper(changeHistory[changeHistoryIndex-1].getIndividualEntries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),entryKey=_step$value[0],data=_step$value[1];if(entryKey=='table'){console.log('table: ');updateTableDimensions(data.getStyleMap());}else if(!/\\.col\\d+/.test(entryKey)){var entry=document.getElementById(entryKey.match(/\\.row\\d+/));applyChange(entry,data.getStyleMap());}else{var _entry=document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));applyChange(_entry,data.getStyleMap(),data.getVal());}}}catch(err){_iterator.e(err);}finally{_iterator.f();}var _iterator2=_createForOfIteratorHelper(changeHistory[changeHistoryIndex-1].getGroupEntries()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),group=_step2$value[0],styleMap=_step2$value[1];console.log('group: '+group);applyGroupChange(group,styleMap);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var updatedCollectedData=updateCollectedData(changeHistory[changeHistoryIndex-1],collectedData);console.log('Undo\\nchangeHistoryIndex: '+(changeHistoryIndex-1));store.dispatch(undoAction({collectedData:updatedCollectedData}));}else if(enableTest)store.dispatch(trackEvent({outcome:UNDO}));}function redo(){var storeState=store.getState();var changeHistoryIndex=storeState.history.changeHistoryIndex;var changeHistory=storeState.history.changeHistory;var collectedData=storeState.history.collectedData;var enableTest=storeState.keyboardEvents.enableTest;var timeTravelCounter=storeState.keyboardEvents.timeTravelCounter;if(changeHistoryIndex<changeHistory.length-1){if(enableTest)store.dispatch(trackEvent({outcome:REDO,timeTravelCounter:timeTravelCounter+1}));var _iterator3=_createForOfIteratorHelper(changeHistory[changeHistoryIndex+1].getIndividualEntries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),entryKey=_step3$value[0],data=_step3$value[1];if(entryKey=='table'){updateTableDimensions(data.getStyleMap(),updateTableDimensions);}else if(!/\\.col\\d+/.test(entryKey)){var entry=document.getElementById(entryKey.match(/\\.row\\d+$/));applyChange(entry,data.getStyleMap());}else{var _entry2=document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));applyChange(_entry2,data.getStyleMap(),data.getVal());}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}var _iterator4=_createForOfIteratorHelper(changeHistory[changeHistoryIndex+1].getGroupEntries()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),group=_step4$value[0],styleMap=_step4$value[1];applyGroupChange(group,styleMap);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}var updatedCollectedData=updateCollectedData(changeHistory[changeHistoryIndex+1],collectedData);console.log('Redo\\nchangeHistoryIndex: '+(changeHistoryIndex+1));store.dispatch(redoAction({collectedData:updatedCollectedData}));}else if(enableTest)store.dispatch(trackEvent({outcome:REDO}));}export{undo,redo};","map":{"version":3,"names":["updateTableDimensions","applyChange","applyGroupChange","updateCollectedData","store","trackEvent","undo","undoAction","redo","redoAction","UNDO","REDO","storeState","getState","changeHistoryIndex","history","changeHistory","collectedData","enableTest","keyboardEvents","timeTravelCounter","dispatch","outcome","getIndividualEntries","entryKey","data","console","log","getStyleMap","test","entry","document","getElementById","match","querySelector","getVal","getGroupEntries","group","styleMap","updatedCollectedData","length"],"sources":["C:/Users/rband/Desktop/SpreadsheetPanel/client/src/data/modifiers/undoRedo.js"],"sourcesContent":["import { updateTableDimensions, applyChange, applyGroupChange } from './applyChange.js';\r\nimport updateCollectedData from './updateCollectedData.js';\r\nimport { store } from './../../store/store.js'\r\nimport { trackEvent } from \"./../../store/reducers/keyboardEventsSlice.js\";\r\nimport { undo as undoAction, redo as redoAction } from './../../store/reducers/historySlice.js'\r\n\r\nconst UNDO = 'Undo';\r\nconst REDO = 'Redo';\r\n\r\nfunction undo() {\r\n    const storeState = store.getState();\r\n    const changeHistoryIndex = storeState.history.changeHistoryIndex;\r\n    const changeHistory = storeState.history.changeHistory;\r\n    const collectedData = storeState.history.collectedData;\r\n    const enableTest = storeState.keyboardEvents.enableTest;\r\n    const timeTravelCounter = storeState.keyboardEvents.timeTravelCounter;\r\n    if (changeHistoryIndex > 0) {\r\n        if (enableTest) store.dispatch(trackEvent({ outcome: UNDO, timeTravelCounter: timeTravelCounter + 1 }));\r\n        for (const [entryKey, data] of changeHistory[changeHistoryIndex - 1].getIndividualEntries()) {\r\n            if (entryKey == 'table') {\r\n                console.log('table: ');\r\n                updateTableDimensions(data.getStyleMap());\r\n            }\r\n            else if (!/\\.col\\d+/.test(entryKey)) {\r\n                let entry = document.getElementById(entryKey.match(/\\.row\\d+/));\r\n                applyChange(entry, data.getStyleMap());\r\n            } else {\r\n                let entry = document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));\r\n                applyChange(entry, data.getStyleMap(), data.getVal());\r\n            }\r\n        }\r\n        for (const [group, styleMap] of changeHistory[changeHistoryIndex - 1].getGroupEntries()) {\r\n            console.log('group: ' + group);\r\n            applyGroupChange(group, styleMap);\r\n        }\r\n        let updatedCollectedData = updateCollectedData(changeHistory[changeHistoryIndex - 1], collectedData);\r\n        console.log('Undo\\nchangeHistoryIndex: ' + (changeHistoryIndex - 1));\r\n        store.dispatch(undoAction({ collectedData: updatedCollectedData }));\r\n    } else if (enableTest) store.dispatch(trackEvent({ outcome: UNDO }));\r\n}\r\n\r\nfunction redo() {\r\n    const storeState = store.getState();\r\n    const changeHistoryIndex = storeState.history.changeHistoryIndex;\r\n    const changeHistory = storeState.history.changeHistory;\r\n    const collectedData = storeState.history.collectedData;\r\n    const enableTest = storeState.keyboardEvents.enableTest;\r\n    const timeTravelCounter = storeState.keyboardEvents.timeTravelCounter;\r\n    if (changeHistoryIndex < changeHistory.length - 1) {\r\n        if (enableTest) store.dispatch(trackEvent({ outcome: REDO, timeTravelCounter: timeTravelCounter + 1 }));\r\n        for (const [entryKey, data] of changeHistory[changeHistoryIndex + 1].getIndividualEntries()) {\r\n            if (entryKey == 'table') {\r\n                updateTableDimensions(data.getStyleMap(), updateTableDimensions);\r\n            } else if (!/\\.col\\d+/.test(entryKey)) {\r\n                let entry = document.getElementById(entryKey.match(/\\.row\\d+$/));\r\n                applyChange(entry, data.getStyleMap());\r\n            } else {\r\n                let entry = document.querySelector(entryKey.match(/\\.row\\d+\\.col\\d+$/));\r\n                applyChange(entry, data.getStyleMap(), data.getVal())\r\n            }\r\n        }\r\n        for (const [group, styleMap] of changeHistory[changeHistoryIndex + 1].getGroupEntries()) {\r\n            applyGroupChange(group, styleMap);\r\n        }\r\n        let updatedCollectedData = updateCollectedData(changeHistory[changeHistoryIndex + 1], collectedData);\r\n        console.log('Redo\\nchangeHistoryIndex: ' + (changeHistoryIndex + 1));\r\n        store.dispatch(redoAction({ collectedData: updatedCollectedData }));\r\n    } else if (enableTest) store.dispatch(trackEvent({ outcome: REDO }));\r\n}\r\nexport { undo, redo }"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}